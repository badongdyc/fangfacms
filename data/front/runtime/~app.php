<?php  defined('IN') or die('Access Denied!'); function is_utf8($string) { return preg_match('%^(?:
		 [\x09\x0A\x0D\x20-\x7E]            # ASCII
	   | [\xC2-\xDF][\x80-\xBF]             # non-overlong 2-byte
	   |  \xE0[\xA0-\xBF][\x80-\xBF]        # excluding overlongs
	   | [\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}  # straight 3-byte
	   |  \xED[\x80-\x9F][\x80-\xBF]        # excluding surrogates
	   |  \xF0[\x90-\xBF][\x80-\xBF]{2}     # planes 1-3
	   | [\xF1-\xF3][\x80-\xBF]{3}          # planes 4-15
	   |  \xF4[\x80-\x8F][\x80-\xBF]{2}     # plane 16
   )*$%xs', $string); } function filter_xss($string, $allowedtags = '', $disabledattributes = array('onabort', 'onactivate', 'onafterprint', 'onafterupdate', 'onbeforeactivate', 'onbeforecopy', 'onbeforecut', 'onbeforedeactivate', 'onbeforeeditfocus', 'onbeforepaste', 'onbeforeprint', 'onbeforeunload', 'onbeforeupdate', 'onblur', 'onbounce', 'oncellchange', 'onchange', 'onclick', 'oncontextmenu', 'oncontrolselect', 'oncopy', 'oncut', 'ondataavaible', 'ondatasetchanged', 'ondatasetcomplete', 'ondblclick', 'ondeactivate', 'ondrag', 'ondragdrop', 'ondragend', 'ondragenter', 'ondragleave', 'ondragover', 'ondragstart', 'ondrop', 'onerror', 'onerrorupdate', 'onfilterupdate', 'onfinish', 'onfocus', 'onfocusin', 'onfocusout', 'onhelp', 'onkeydown', 'onkeypress', 'onkeyup', 'onlayoutcomplete', 'onload', 'onlosecapture', 'onmousedown', 'onmouseenter', 'onmouseleave', 'onmousemove', 'onmoveout', 'onmouseover', 'onmouseup', 'onmousewheel', 'onmove', 'onmoveend', 'onmovestart', 'onpaste', 'onpropertychange', 'onreadystatechange', 'onreset', 'onresize', 'onresizeend', 'onresizestart', 'onrowexit', 'onrowsdelete', 'onrowsinserted', 'onscroll', 'onselect', 'onselectionchange', 'onselectstart', 'onstart', 'onstop', 'onsubmit', 'onunload')) { if(is_array($string)) { foreach($string as $key => $val) $string[$key] = filter_xss($val, $allowedtags); } else { $string = preg_replace('/\s('.implode('|', $disabledattributes).').*?([\s\>])/', '\\2', preg_replace('/<(.*?)>/ie', "'<'.preg_replace(array('/javascript:[^\"\']*/i', '/(".implode('|', $disabledattributes).")[ \\t\\n]*=[ \\t\\n]*[\"\'][^\"\']*[\"\']/i', '/\s+/'), array('', '', ' '), stripslashes('\\1')) . '>'", strip_tags($string, $allowedtags))); } return $string; } function h404($msg) { send_http_status(404); include TMPL_PATH . 'system/404.php'; exit (); } function safe_replace($string) { $string = str_replace('%20','',$string); $string = str_replace('%27','',$string); $string = str_replace('*','',$string); $string = str_replace('"','&quot;',$string); $string = str_replace("'",'',$string); $string = str_replace("\"",'',$string); $string = str_replace('//','',$string); $string = str_replace(';','',$string); $string = str_replace('<','&lt;',$string); $string = str_replace('>','&gt;',$string); $string = str_replace('(','',$string); $string = str_replace(')','',$string); $string = str_replace("{",'',$string); $string = str_replace('}','',$string); return $string; } function array_remove_empty(& $arr, $trim = true) { foreach ($arr as $key => $value) { if (is_array($value)) { array_remove_empty($arr[$key]); } else { $value = trim($value); if ($value == '') { unset($arr[$key]); } elseif ($trim) { $arr[$key] = $value; } } } } function parse_module () { $var_module = C('VAR_MODULE'); $var_action = C('VAR_ACTION'); $php_self = safe_replace($_SERVER['PHP_SELF']); $query_script = substr($php_self,strlen(__ROOT__) + 11); $query_script = str_replace('//','/',$query_script); $url_suffix = C('URL_HTML_SUFFIX'); if (!empty($query_script) && $query_script!=('index'.$url_suffix) ) { if (strpos($query_script,'/')) { $param = explode('/',$query_script); } else { $param[0] = $query_script; } array_remove_empty($param); $_category = D ('Category'); if (substr($param[0],-strlen($url_suffix)) == $url_suffix) { if (strpos($param[0],'_')) { $page_param = explode('_',$param[0]); $page = str_replace($url_suffix,'',array_pop($page_param)); if (is_numeric($page) && $page>0) { $caturl = str_replace('_'.$page,'',$param[0]); } } else { $caturl = &$param[0]; } $category_data = $_category->field("`catid`")->where("`url`='{$caturl}' AND `type`<>'link'")->find(); $param = ''; $request_file = $query_script; } else { $category_data = $_category->field("`catid`")->where("`catdir`='{$param[0]}'")->find(); array_shift($param); if (strpos($query_script,$url_suffix)) { if (__ROOT__ == '') { $request_file = substr($_SERVER['REQUEST_URI'] ,1); } else { $request_file = substr($_SERVER['REQUEST_URI'],strlen(__ROOT__)+1); } } else { $request_file = rtrim(substr($_SERVER['REQUEST_URI'],strlen(__ROOT__)+1),'/'). '/index' . $url_suffix; } } define('CATID',$category_data['catid'] ? $category_data['catid'] : 0); $category_data = F ('category_'.$category_data['catid']); if ($category_data['controller']) { $_POST[$var_module] = $category_data['controller']; $_GET[$var_module] = $category_data['controller']; } else { Dispatcher::dispatch(); } C('CREATE_HTML',(boolean)$category_data['ishtml']); } else { $_POST[$var_module] = 'Findex'; $_GET[$var_module] = 'Findex'; $request_file = 'index' . $url_suffix; } $request_file = str_replace('//','/',$request_file); define('REQUEST_FILE',$request_file); return ; } function multi($num, $curr_page, $mpurl, $perpage = 10, $goto = true, $config = array( 'first'=> '首页', 'pre' => '&lt;', 'next' => '&gt;', 'last' => '末页', 'goto' => '转到 第  %s 页', 'total' => '当前%d/%d页 共有 <em>%d</em> 条记录' )) { $multipage = ''; if ($num > $perpage) { $page = 10; $offset = 2; $pages = ceil ( $num / $perpage ); $from = $curr_page - $offset; $to = $curr_page + $page - $offset - 1; if ($page > $pages) { $from = 1; $to = $pages; } else { if ($from < 1) { $to = $curr_page + 1 - $from; $from = 1; if (($to - $from) < $page && ($to - $from) < $pages) { $to = $page; } } elseif ($to > $pages) { $from = $curr_page - $pages + $to; $to = $pages; if (($to - $from) < $page && ($to - $from) < $pages) { $from = $pages - $page + 1; } } } $multipage .= '<div class="pagelist">'; $multipage .= '<ul>'; if ($curr_page>1 && $pages>=$curr_page) { if ($curr_page>2) { $multipage .= '<li><a href="'. str_replace ( '{page}', ($curr_page-1), $mpurl ).'" >'.$config['pre'].'</a></li>'; } else { if (strpos($mpurl,'_{page}')) { $multipage .= '<li><a href="'. str_replace ( '_{page}', '', $mpurl ).'" >'.$config['pre'].'</a></li>'; } elseif (strpos($mpurl,'{page}')) { $multipage .= '<li><a href="'. str_replace ( '{page}', ($curr_page-1), $mpurl ).'" >'.$config['pre'].'</a></li>'; } } } else { if (strpos($mpurl,'_{page}')) { $multipage .= '<li><a href="'. str_replace ( '_{page}', '', $mpurl ).'" >'.$config['pre'].'</a></li>'; } elseif (strpos($mpurl,'{page}')) { $multipage .= '<li><a href="'. str_replace ( '{page}', ($curr_page-1), $mpurl ).'" >'.$config['pre'].'</a></li>'; } } for($i = $from; $i <= $to; $i ++) { if ($i != $curr_page) { if ($i == 1) { if (false !== strpos($mpurl,'_{page}')) { $multipage .= '<li><a href="'. str_replace ( '_{page}', '', $mpurl ).'" >1</a></li>'; } elseif (false !== strpos($mpurl,'{page}')) { $multipage .= '<li><a href="'. str_replace ( '{page}', 1, $mpurl ).'" >1</a></li>'; } } else { $multipage .= '<li><a href="'. str_replace ( '{page}', $i, $mpurl ).'" >'.$i.'</a></li>'; } } else { $multipage .= '<li class="now"><a href="javascript:;"  style="color:#fff;">'.$i.'</a></li>'; } } if ($curr_page>0 && $curr_page<$pages) { $multipage .= '<li class="noma"><a href="'. str_replace ( '{page}', ($curr_page+1), $mpurl ).'" >'.$config['next'].'</a></li>'; } else { $multipage .= '<li class="noma"><a href="'. str_replace ( '{page}', $curr_page, $mpurl ).'"  >'.$config['next'].'</a></li>'; } $multipage .= '</ul>'; $multipage .= '</div>'; } return $multipage; } function getSp($arr){ echo "<pre>"; print_r($arr); echo "</pre>"; exit(); } return array ( 'app_debug' => false, 'app_domain_deploy' => false, 'app_plugin_on' => true, 'app_file_case' => false, 'app_group_depr' => '.', 'app_group_list' => '', 'app_autoload_reg' => false, 'app_autoload_path' => 'Think.Util.', 'app_config_list' => array ( 0 => 'taglibs', 1 => 'routes', 2 => 'tags', 3 => 'htmls', 4 => 'modules', 5 => 'actions', ), 'cookie_expire' => 3600, 'cookie_domain' => '', 'cookie_path' => '/', 'cookie_prefix' => '', 'default_app' => '@', 'default_group' => 'Home', 'default_module' => 'Findex', 'default_action' => '', 'default_charset' => 'utf-8', 'default_timezone' => 'Asia/Chongqing', 'default_ajax_return' => 'JSON', 'default_theme' => 'default', 'default_lang' => 'zh-cn', 'db_type' => 'mysql', 'db_host' => 'localhost', 'db_name' => 'bxdytz', 'db_user' => 'root', 'db_pwd' => '', 'db_port' => '3306', 'db_prefix' => 'fangfa_', 'db_suffix' => '', 'db_fieldtype_check' => false, 'db_fields_cache' => true, 'db_charset' => 'utf8', 'db_deploy_type' => 0, 'db_rw_separate' => false, 'data_cache_time' => -1, 'data_cache_compress' => false, 'data_cache_check' => false, 'data_cache_type' => 'File', 'data_cache_path' => 'D:\\wamp\\www\\bxdy/data/front/runtime/tmp/', 'data_cache_subdir' => false, 'data_path_level' => 1, 'error_message' => '您浏览的页面暂时发生了错误！请稍后再试～', 'error_page' => '', 'html_cache_on' => false, 'html_cache_time' => 60, 'html_read_type' => 0, 'html_file_suffix' => '.shtml', 'lang_switch_on' => false, 'lang_auto_detect' => true, 'log_record' => 'false', 'log_file_size' => 2097152, 'log_record_level' => array ( 0 => 'EMERG', 1 => 'ALERT', 2 => 'CRIT', 3 => 'ERR', ), 'page_rollpage' => 5, 'page_listrows' => 20, 'session_auto_start' => true, 'show_run_time' => false, 'show_adv_time' => false, 'show_db_times' => false, 'show_cache_times' => false, 'show_use_mem' => false, 'show_page_trace' => false, 'show_error_msg' => true, 'tmpl_engine_type' => 'Smarty', 'tmpl_detect_theme' => false, 'tmpl_template_suffix' => '.html', 'tmpl_cachfile_suffix' => '.php', 'tmpl_deny_func_list' => 'echo,exit', 'tmpl_parse_string' => '', 'tmpl_l_delim' => '{', 'tmpl_r_delim' => '}', 'tmpl_var_identify' => 'array', 'tmpl_strip_space' => false, 'tmpl_cache_on' => true, 'tmpl_cache_time' => -1, 'tmpl_action_error' => 'system/message.html', 'tmpl_action_success' => 'system/message.html', 'tmpl_trace_file' => 'D:\\wamp\\www\\bxdy/include/library/ThinkPHP//Tpl/PageTrace.tpl.php', 'tmpl_exception_file' => 'D:\\wamp\\www\\bxdy/front/Tpl/Exception.tpl.php', 'tmpl_file_depr' => '/', 'taglib_begin' => '<', 'taglib_end' => '>', 'taglib_load' => true, 'taglib_build_in' => 'cx', 'taglib_pre_load' => '', 'tag_nested_level' => 3, 'tag_extend_parse' => '', 'token_on' => true, 'token_name' => '__hash__', 'token_type' => 'md5', 'url_case_insensitive' => true, 'url_router_on' => true, 'url_dispatch_on' => false, 'url_model' => 2, 'url_pathinfo_model' => 2, 'url_pathinfo_depr' => '/', 'url_html_suffix' => '.html', 'var_group' => 'g', 'var_module' => 'm', 'var_action' => 'a', 'var_router' => 'r', 'var_page' => 'p', 'var_template' => 't', 'var_language' => 'l', 'var_ajax_submit' => 'ajax', 'var_pathinfo' => 's', 'tmpl_action_message' => 'system/message.html', 'tmpl_engine_config' => array ( 'caching' => false, 'template_dir' => 'D:\\wamp\\www\\bxdy/public/theme/default/', 'compile_dir' => 'D:\\wamp\\www\\bxdy/data/front/runtime/templates_c', 'cache_dir' => 'D:\\wamp\\www\\bxdy/data/front/runtime/tmp/', 'left_delimiter' => '{{', 'right_delimiter' => '}}', 'debugging' => false, 'plugins_dir' => array ( 0 => 'plugins', 1 => 'D:\\wamp\\www\\bxdy/include//tag', ), ), 'allowed_htmltags' => '<a><p><br><hr><h1><h2><h3><h4><h5><h6><font><u><i><b><strong><div><span><ol><ul><li><img><table><tr><td><map>', 'gzip' => 0, 'upload_maxsize' => '1024', 'fileext' => array ( 0 => 'jpg', 1 => 'gif', 2 => 'png', 3 => 'rar', 4 => 'zip', ), 'multi' => false, 'upload_file_rule' => 'times', 'upload_dir' => 'public/uploads/', 'warter_mark' => false, 'thumb' => false, 'site_url' => 'http://www.stdyc.com', 'site_root' => '/', 'icpno' => '蜀ICP备09052756号-1', 'copyright' => 'Copyright © 2015 四川北新达亿投资有限公司', 'session_save_path' => 'data/session', 'editor_type' => 'ueditor', 'upload_attachment_allowext' => 'doc|docx|xls|ppt|wps|zip|rar|txt', 'upload_images_allowext' => 'jpg|jpeg|gif|bmp|png', 'upload_thumb_isthumb' => '0', 'upload_thumb_width' => '150', 'upload_thumb_height' => '150', 'upload_water_iswatermark' => '0', 'upload_water_place' => '9', 'upload_water_path' => 'images/watermark.png', 'upload_water_trans' => '50', 'user_auth_cookie_key' => '', 'content_comment_open' => 0, 'comment_user_login' => 0, 'create_html' => '', 'pagesize' => '20', 'site_title_separator' => '-', 'siteurl' => 'http://www.stdyc.com', 'seotitle' => '北新达亿投资', 'seokeywords' => '北新达亿投资', 'seodescription' => '北新达亿投资', 'companyname' => '-四川北新达亿投资有限公司2', 'companylinkman' => '-', 'companytel' => '028-13465456', 'companyfax' => '-', 'companyemail' => '028-', 'companyaddress' => '- 四川北新达亿投资有限公司1', 'mail_type' => '1', 'mail_server' => 'smtp.qq.com', 'mail_port' => '25', 'mail_user' => '314112521@qq.com', 'mail_password' => 'cngpmjgbsjtnbifi', 'upload_url' => 'uploads/', 'watermark_minwidth' => '100', 'watermark_minheight' => '100', 'watermark_quality' => '90', 'auto_ping' => '0', 'ping_sites' => 'http://blogsearch.google.com/ping/RPC2', 'filter_word' => '去死|贱人|我操|我日|反党|反共|共产党|法轮功|强奸|黑社会|疆独|藏独|K粉|冰毒|枪支|共铲党', 'user_open_register' => '0', 'user_default_role_id' => '2', 'user_need_active' => '0', 'user_passport_on' => '0', 'is_brcode' => '1', 'brcode_size' => '4', 'is_cut' => '0', 'cut_size' => '475', 'is_comment' => '0', '_routes_' => array ( 'sitemap' => array ( 0 => 'Findex', 1 => 'sitemap', ), 'login' => array ( 0 => 'Findex', 1 => 'login', ), 'register' => array ( 0 => 'Findex', 1 => 'register', ), 'form' => array ( 0 => 'Findex', 1 => 'form', ), 'email' => array ( 0 => 'Femail', 1 => 'index', ), 'forget' => array ( 0 => 'Fuser', 1 => 'forget', ), 'r' => array ( 0 => 'Findex', 1 => 'redirect', ), 'code' => array ( 0 => 'Findex', 1 => 'verify', ), 'down' => array ( 0 => 'Fcontent', 1 => 'down', ), 'count' => array ( 0 => 'Fcontent', 1 => 'count', ), 'tag' => array ( 0 => 'Fcontent', 1 => 'tag', ), 'search' => array ( 0 => 'Fsearch', 1 => 'index', ), 'upload' => array ( 0 => 'Fupload', 1 => 'fieldupload', ), 'user@' => array ( 0 => array ( 0 => '/home/', 1 => 'Fuser', 2 => 'home', ), 1 => array ( 0 => '/edit/', 1 => 'Fuser', 2 => 'edit', ), 2 => array ( 0 => '/logout/', 1 => 'Fuser', 2 => 'logout', ), ), 'cart@' => array ( 0 => array ( 0 => '/show/', 1 => 'Fcart', 2 => 'show', ), ), 'order@' => array ( 0 => array ( 0 => '/submit/', 1 => 'Forder', 2 => 'submit', ), ), 'comment@' => array ( 0 => array ( 0 => '/add/', 1 => 'Fcomment', 2 => 'add', ), 1 => array ( 0 => '/show-\\d{1,}-\\d.+/', 1 => 'Fcomment', 2 => 'show', ), ), ), '_tags_' => array ( 'app_begin' => array ( 0 => 'init_sesstion', ), 'app_before_get_module' => array ( 0 => 'parse_module', ), ), ); ?>